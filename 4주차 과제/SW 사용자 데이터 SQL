<!--일자별 접속자 수-->
  SELECT
      DATE_FORMAT(STR_TO_DATE(CONCAT('20', create_date), '%Y%m%d%H%i'), '%Y%m%d') AS statDate,
      COUNT(DISTINCT user_id) AS userCnt
  FROM
      statistic.request_info
  WHERE
      DATE_FORMAT(STR_TO_DATE(CONCAT('20', create_date), '%Y%m%d%H%i'), '%Y%m%d') = #{statDateValue}
  GROUP BY
      statDate;
    
<!--평균 하루 로그인 수-->
  SELECT
      AVG(daily_login_count)
  FROM (
      SELECT
          COUNT(*) AS daily_login_count
      FROM
         statistic.request_info
      GROUP BY
          LEFT(create_date, 6)
  ) AS daily_counts;

<!--휴일을 제외한 로그인 수-->
  SELECT
      COUNT(*)
  FROM
      statistic.request_info ri
  LEFT JOIN
      statistic.holidays h ON STR_TO_DATE(LEFT(ri.create_date, 6), '%y%m%d') = h.holiday_date
  WHERE
      DAYOFWEEK(STR_TO_DATE(LEFT(ri.create_date, 6), '%y%m%d')) NOT IN (1, 7)
  AND h.holiday_date IS NULL;
  
<!--년월별 사용자 접속자수-->
  SELECT
      DATE_FORMAT(STR_TO_DATE(CONCAT('20', create_date), '%Y%m%d%H%i'), '%Y%m') AS yearMonth,
      COUNT(DISTINCT user_id) AS userCnt
  FROM
      statistic.request_info
  WHERE
      DATE_FORMAT(STR_TO_DATE(CONCAT('20', create_date), '%Y%m%d%H%i'), '%Y%m') = #{yearMonthValue}
  GROUP BY
      yearMonth;
      
<!--년월별 로그인 요청 수-->
  SELECT
      DATE_FORMAT(STR_TO_DATE(CONCAT('20', create_date), '%Y%m%d%H%i'), '%Y%m') AS yearMonth,
      COUNT(*) AS loginCnt
  FROM
      statistic.request_info
  WHERE
      DATE_FORMAT(STR_TO_DATE(CONCAT('20', create_date), '%Y%m%d%H%i'), '%Y%m') = #{yearMonthValue}
  GROUP BY
      yearMonth;
      
<!--년월별 부서별 사용자 접속자수-->
  SELECT
      d.hr_organ AS deptCode,
      DATE_FORMAT(STR_TO_DATE(CONCAT('20', ri.create_date), '%Y%m%d%H%i'), '%Y%m') AS yearMonth,
      COUNT(DISTINCT ri.user_id) AS userCnt
  FROM
      statistic.request_info ri
  JOIN
      statistic.user u ON ri.user_id = u.user_id
  JOIN
      statistic.departments d ON u.department_id = d.department_id
  WHERE
      DATE_FORMAT(STR_TO_DATE(CONCAT('20', ri.create_date), '%Y%m%d%H%i'), '%Y%m') = #{yearMonth}
      AND d.department_id = #{departmentId}
  GROUP BY
      deptCode, yearMonth;
      
<!--년월별 부서별 로그인 요청 수-->
  SELECT
      d.hr_organ AS deptCode,
      DATE_FORMAT(STR_TO_DATE(CONCAT('20', ri.create_date), '%Y%m%d%H%i'), '%Y%m') AS yearMonth,
      COUNT(*) AS loginCnt
  FROM
      statistic.request_info ri
  JOIN
      statistic.user u ON ri.user_id = u.user_id
  JOIN
      statistic.departments d ON u.department_id = d.department_id
  WHERE
      DATE_FORMAT(STR_TO_DATE(CONCAT('20', ri.create_date), '%Y%m%d%H%i'), '%Y%m') = #{yearMonth}
      AND d.department_id = #{departmentId}
  GROUP BY
      d.hr_organ, yearMonth;
      
<!--년월별 게시글 작성 수-->
  SELECT
      board_id AS boardId,
      DATE_FORMAT(created_at, '%Y%m') AS yearMonth,
      COUNT(*) AS postCnt
  FROM
      posts
  WHERE
      board_id = #{boardId}
      AND DATE_FORMAT(created_at, '%Y%m') = #{yearMonth}
  GROUP BY
      boardId, yearMonth;
